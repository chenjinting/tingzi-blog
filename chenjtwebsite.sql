-- phpMyAdmin SQL Dump
-- version 4.0.4
-- http://www.phpmyadmin.net
--
-- 主机: localhost
-- 生成日期: 2016 年 06 月 05 日 20:26
-- 服务器版本: 5.5.36
-- PHP 版本: 5.4.12

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;

--
-- 数据库: `chenjtwebsite`
--
CREATE DATABASE IF NOT EXISTS `chenjtwebsite` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
USE `chenjtwebsite`;

-- --------------------------------------------------------

--
-- 表的结构 `cjt_admin`
--

CREATE TABLE IF NOT EXISTS `cjt_admin` (
  `id` int(5) unsigned NOT NULL AUTO_INCREMENT COMMENT '用户id',
  `username` varchar(40) NOT NULL COMMENT '用户名',
  `password` varchar(50) NOT NULL COMMENT '密码',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=10 ;

--
-- 转存表中的数据 `cjt_admin`
--

INSERT INTO `cjt_admin` (`id`, `username`, `password`) VALUES
(1, 'cjt', 'e10adc3949ba59abbe56e057f20f883e'),
(2, 'chenjinting', '03c7c0ace395d80182db07ae2c30f034'),
(3, 'z', 'd41d8cd98f00b204e9800998ecf8427e'),
(4, 'qw', '7694f4a66316e53c8cdd9d9954bd611d'),
(6, 'e', 'd41d8cd98f00b204e9800998ecf8427e'),
(7, 'u', 'd41d8cd98f00b204e9800998ecf8427e'),
(8, '41', 'd41d8cd98f00b204e9800998ecf8427e'),
(9, '的', 'd41d8cd98f00b204e9800998ecf8427e');

-- --------------------------------------------------------

--
-- 表的结构 `cjt_article`
--

CREATE TABLE IF NOT EXISTS `cjt_article` (
  `id` int(5) unsigned NOT NULL AUTO_INCREMENT,
  `title` varchar(120) NOT NULL COMMENT '标题',
  `author` varchar(20) DEFAULT NULL COMMENT '作者',
  `coverpic` varchar(100) DEFAULT 'default.jpg' COMMENT '封面',
  `abstract` text COMMENT '文章摘要内容',
  `content` longtext NOT NULL COMMENT '内容',
  `readnum` int(20) DEFAULT '0' COMMENT '文章阅读量',
  `sortid` int(5) NOT NULL COMMENT '分类id',
  `time` int(20) DEFAULT NULL COMMENT '发布时间',
  `lastmodifytime` int(20) DEFAULT NULL COMMENT '最后编辑时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=197 ;

--
-- 转存表中的数据 `cjt_article`
--

INSERT INTO `cjt_article` (`id`, `title`, `author`, `coverpic`, `abstract`, `content`, `readnum`, `sortid`, `time`, `lastmodifytime`) VALUES
(182, '测试1', '', 'default.jpg', '测试摘要1', '&lt;p&gt;测试内容1&lt;/p&gt;', 0, 1, 1465155265, 1465155265),
(183, '测试2', '', 'default.jpg', '测试摘要2', '&lt;p&gt;测试内容2&lt;/p&gt;', 0, 10, 1465155293, 1465155293),
(184, '测试3', '', 'default.jpg', '测试摘要3', '&lt;p&gt;测试内容3&lt;/p&gt;', 0, 11, 1465155314, 1465155314),
(185, '测试4', '陈锦', 'default.jpg', '测试摘要4', '&lt;p&gt;测试内容4&lt;/p&gt;', 0, 12, 1465155349, 1465155349),
(186, '测试5', '', 'default.jpg', '测试摘要5', '&lt;p&gt;测试内容5&lt;/p&gt;', 0, 14, 1465155378, 1465155378),
(187, '测试6', '', 'default.jpg', '测试摘要6', '&lt;p&gt;测试内容6&lt;/p&gt;', 0, 14, 1465155403, 1465155403),
(188, '测试7', '', 'default.jpg', '测试摘要7', '&lt;p&gt;测试内容7&lt;/p&gt;', 0, 25, 1465155433, 1465155433),
(189, '测试8', '', 'default.jpg', '测试摘要8', '&lt;p&gt;测试内容8&lt;/p&gt;', 0, 26, 1465155462, 1465155462),
(190, '测试9', '', 'default.jpg', '测试摘要9', '&lt;p&gt;测试内容9&lt;/p&gt;', 0, 26, 1465155488, 1465155488),
(191, '测试10', '', 'default.jpg', '测试摘要10', '&lt;p&gt;测试内容10&lt;/p&gt;', 0, 11, 1465155514, 1465155514),
(192, '测试11', '', 'default.jpg', '测试摘要11', '&lt;p&gt;测试内容11&lt;/p&gt;', 0, 1, 1465155536, 1465155536),
(193, '测试12', '', 'default.jpg', '测试摘要12', '&lt;p&gt;测试内容12&lt;/p&gt;', 0, 10, 1465155558, 1465155558),
(194, '测试13', '', 'default.jpg', '测试摘要13', '&lt;p&gt;测试内容13&lt;/p&gt;', 1, 11, 1465155608, 1465155608);
INSERT INTO `cjt_article` (`id`, `title`, `author`, `coverpic`, `abstract`, `content`, `readnum`, `sortid`, `time`, `lastmodifytime`) VALUES
(195, '测试14', '', 'default.jpg', '测试摘要14', '&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;从 14 年双十二结束开始接手淘宝首页，到如今差不多 1 年半时间了，不久前完成了首页相关工作的交接。经历了两次改版和一次从 PHP 到 Node 的迁移，还是颇有感受，下面给大家分享下。&lt;/p&gt;&lt;h3 id=&quot;u4E00_u3001_u76F8_u5173_u80CC_u666F_u4ECB_u7ECD&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.3em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#u4E00_u3001_u76F8_u5173_u80CC_u666F_u4ECB_u7ECD&quot; class=&quot;headerlink&quot; title=&quot;一、相关背景介绍&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 23.3999996185303px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;一、相关背景介绍&lt;/h3&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;淘宝首页是淘宝的门面，承载着几乎淘系所有业务的入口，流量很大，量级单位为亿。近几年无线端崛起，业务重点开始向无线终端偏移（目前不能叫偏移，基本以无线为主了），所以淘宝 PC 端首页的流量也有削减，不过即便如此，它的日均 PV 依然相当高。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;淘宝首页一向是内部平台和技术的试验田，它一直在变化着。最新的框架和系统都会找淘宝首页试点，可以试想下，如果某一项需要推动的升级或者优化措施在淘宝首页已经上线，并且拿到了良好的数据和稳定性，其他业务还有什么理由不去尝试和更迭呢？同时，去年一年身在淘宝前端的技术架构组，自然而然也会主动去 push 一些实验性的内容到业务上。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;淘系的站点页面包括首页、其他频道页和活动页等，这些页面并不都由淘宝前端一行一行的代码码出来，业务如此之多，这种玩法即便人数 double 也忙不过来。事实上，大多数页面都是依托内部的搭建平台——运营或者前端通过模块搭建的方式——构建的，而前端 focus 的重点在于搭建平台的建设自身以及模块的通用性和复用率的保障，当然，还有一些工程化的东西。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;使用搭建平台搭建的页面，前端只需要考虑组成页面的原子模块的开发，整体的渲染由搭建平台提供的统一脚本全权负责。而在淘宝首页上，考虑到页面模块数量巨多，加上还有少量跨部门、跨团队的沟通，渲染模型略微不同。&lt;/p&gt;&lt;h3 id=&quot;u4E8C_u3001_u6DD8_u5B9D_u9996_u9875_u7684_u6574_u4F53_u53D8_u8FC1&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.3em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#u4E8C_u3001_u6DD8_u5B9D_u9996_u9875_u7684_u6574_u4F53_u53D8_u8FC1&quot; class=&quot;headerlink&quot; title=&quot;二、淘宝首页的整体变迁&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 23.3999996185303px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;二、淘宝首页的整体变迁&lt;/h3&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;背景中提到，淘宝首页依托于内部搭建平台，它的变迁自然也是跟着搭建系统的变化而变化的。&lt;/p&gt;&lt;h4 id=&quot;1-_PHP__u4E0B_u7684_u6DD8_u5B9D_u9996_u9875&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.2em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#1-_PHP__u4E0B_u7684_u6DD8_u5B9D_u9996_u9875&quot; class=&quot;headerlink&quot; title=&quot;1. PHP 下的淘宝首页&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 21.6000003814697px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;1. PHP 下的淘宝首页&lt;/h4&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;接手淘宝首页不久，便遇到了一年一度的改版，那时它还运行在 PHP 环境中。这里需要说明的是，淘宝首页的所有代码完全由前端掌控，前端不会直接跟数据库打交道，其数据来源分为两部分。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;strong style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;数据来源&lt;/strong&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;一是&amp;nbsp;&lt;em style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;运营填写的数据。&lt;/em&gt;&amp;nbsp;采用前端挖坑的形式，预留坑位让运营获取填写数据，如（伪代码）：&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure class=&quot;highlight php&quot; style=&quot;margin: 0px; padding: 15px 20px; border-style: solid; border-color: rgb(221, 221, 221); border-width: 1px 0px; overflow: auto; color: rgb(77, 77, 76); line-height: 22.4px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; white-space: normal; background: rgb(255, 255, 255);&quot;&gt;&lt;table width=&quot;NaN&quot;&gt;&lt;tbody style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;&lt;tr style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot; class=&quot;firstRow&quot;&gt;&lt;td class=&quot;gutter&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td class=&quot;code&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;pre style=&quot;margin-top: 0px; margin-bottom: 0px; padding: 0px; border: none; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; overflow: auto; line-height: 22.4px; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;variable&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(200, 40, 41);&quot;&gt;$info&lt;/span&gt; = Person(&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;#39;name:String:姓名,age:Number:年龄&amp;#39;&lt;/span&gt;, &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;#39;个人信息坑位填写&amp;#39;&lt;/span&gt;);&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&amp;lt;div&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;variable&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(200, 40, 41);&quot;&gt;$info&lt;/span&gt;.&lt;span class=&quot;keyword&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(137, 89, 168);&quot;&gt;forEach&lt;/span&gt;(index) { &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;Name: &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= info[index].name &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;, Age: &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= info[index].age &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?php&lt;/span&gt; } &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;上面的代码会产生一份 PHP 的模板和 info 字段对应的表单坑位，这个过程简称「挖坑」。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww4.sinaimg.cn/large/6c0378f8gw1f4g54zdicej20do09cdfy.jpg&quot; alt=&quot;挖坑&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;运营填写这些坑位就会产生这份 PHP 模板对应的数据，最后渲染出来就是一个完整的 HTML 片段（实时性渲染）。&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure class=&quot;highlight bash&quot; style=&quot;margin: 0px; padding: 15px 20px; border-style: solid; border-color: rgb(221, 221, 221); border-width: 1px 0px; overflow: auto; color: rgb(77, 77, 76); line-height: 22.4px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; white-space: normal; background: rgb(255, 255, 255);&quot;&gt;&lt;table width=&quot;NaN&quot;&gt;&lt;tbody style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;&lt;tr style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot; class=&quot;firstRow&quot;&gt;&lt;td class=&quot;gutter&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td class=&quot;code&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;pre style=&quot;margin-top: 0px; margin-bottom: 0px; padding: 0px; border: none; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; overflow: auto; line-height: 22.4px; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;.&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;├── data.json &amp;nbsp; &lt;span class=&quot;comment&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(142, 144, 140);&quot;&gt;# 运营数据的来源&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;└── index.php &amp;nbsp; &lt;span class=&quot;comment&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(142, 144, 140);&quot;&gt;# 装载运营数据的 PHP 模板&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;旧版搭建系统中就是通过这种方式构造一个子模块。我描述得十分简单，但作为一个平台它需要考虑的东西还有很多很多的，比如数据顺序的控制、定时发布、回滚机制、过滤机制、筛选机制、数据的同步、数据的更新、版本控制、权限控制、其他系统的引用等等。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;二是&amp;nbsp;&lt;em style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;后端或者个性化平台提供的数据。&lt;/em&gt;&amp;nbsp;不同的业务有不同的诉求。一些业务有自己的后端，他们要求使用自己业务产出的数据；有的业务希望用户看到的内容不一样，千人千面，期望接入算法；一些业务跟卖家直接打交道，期望使用招商数据；而有些业务期望采用运营从数据池筛选出来的数据…总之，淘宝首页需要对接形形色色的系统，接口繁多。后面会提到对动态数据源的整合。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;并且这些系统对应的域名是不一样的，JSONP 格式自然也就成了首选。但一些特殊的系统，比如广告，它的渲染并不是一个简单的 JSONP 请求，可能它还要干预整个广告的渲染流程，比如加载他们的 JS，把渲染的控制权交过去。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;strong style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;页面的架构&lt;/strong&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;上面介绍了数据的来源和子模块的结构，那么整个页面又是如何构成的呢？模块的搭建分为两种，一种是可视化搭建，运营或者前端可以将开发好的模块（或者模块库中选取的模块）拖拽到容器内，形成一个页面，&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww2.sinaimg.cn/large/6c0378f8gw1f4g51ddlmzj21ao0x4dij.jpg&quot; alt=&quot;模块搭建&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;当然，上图也只是一个模型，作为一个系统需要考虑的问题还有很多很多，如页面的布局、多终端适配、模块的临时隐藏、位置调整、皮肤选择、模块的复制等等。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;也可以通过如下源码搭建的方式（伪代码）：&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure class=&quot;highlight php&quot; style=&quot;margin: 0px; padding: 15px 20px; border-style: solid; border-color: rgb(221, 221, 221); border-width: 1px 0px; overflow: auto; color: rgb(77, 77, 76); line-height: 22.4px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; white-space: normal; background: rgb(255, 255, 255);&quot;&gt;&lt;table width=&quot;NaN&quot;&gt;&lt;tbody style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;&lt;tr style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot; class=&quot;firstRow&quot;&gt;&lt;td class=&quot;gutter&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td class=&quot;code&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;pre style=&quot;margin-top: 0px; margin-bottom: 0px; padding: 0px; border: none; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; overflow: auto; line-height: 22.4px; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= loadModule(Mod1ID) &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= loadModule(Mod2ID) &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= loadModule(Mod3ID, &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;#39;lazyload&amp;#39;&lt;/span&gt;) &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= loadModule(Mod4ID, &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;#39;lazyload&amp;#39;&lt;/span&gt;) &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= loadModule(Mod5ID, &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;#39;lazyload&amp;#39;&lt;/span&gt;) &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;通过模块 id 将模块引入，并且添加一些类似&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;lazyload&lt;/code&gt;&amp;nbsp;的标记，方便控制渲染节奏和数据入口。源码搭建和模块搭建的区别在于，前者更易于控制模块的结构以及模块的渲染顺序。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;strong style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;动态数据源&lt;/strong&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;首页面对一大堆接口和平台，对接几十个业务方，接口是个很大的问题，由于后台系统的差异，基本没有办法统一数据源的格式，一旦运营哪天心血来潮要换一个他自己觉得用的更爽的或者数据更好的系统，前后端估计又得沟通和对接几次。所以出现了下面这张图：&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww2.sinaimg.cn/large/6c0378f8gw1f4g5mwl5jzj218w0psdia.jpg&quot; alt=&quot;动态数据源&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;平台具备数据源接入的能力，也就是说我们挖的坑不仅仅可以让运营填数据，还可以从各种数据源中直接导入数据，当然，这里需要进行一次数据字段的映射转换。后端提供的接口是这样的：&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure class=&quot;highlight javascript&quot; style=&quot;margin: 0px; padding: 15px 20px; border-style: solid; border-color: rgb(221, 221, 221); border-width: 1px 0px; overflow: auto; color: rgb(77, 77, 76); line-height: 22.4px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; white-space: normal; background: rgb(255, 255, 255);&quot;&gt;&lt;table width=&quot;NaN&quot;&gt;&lt;tbody style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;&lt;tr style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot; class=&quot;firstRow&quot;&gt;&lt;td class=&quot;gutter&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td class=&quot;code&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;pre style=&quot;margin-top: 0px; margin-bottom: 0px; padding: 0px; border: none; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; overflow: auto; line-height: 22.4px; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;data&amp;quot;&lt;/span&gt;: [{&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;item_name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;item_url&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;http://xxx&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;item_pic&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;http://xxx&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;}]&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;前端约定的接口形式是:&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure class=&quot;highlight javascript&quot; style=&quot;margin: 0px; padding: 15px 20px; border-style: solid; border-color: rgb(221, 221, 221); border-width: 1px 0px; overflow: auto; color: rgb(77, 77, 76); line-height: 22.4px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; white-space: normal; background: rgb(255, 255, 255);&quot;&gt;&lt;table width=&quot;NaN&quot;&gt;&lt;tbody style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;&lt;tr style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot; class=&quot;firstRow&quot;&gt;&lt;td class=&quot;gutter&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td class=&quot;code&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;pre style=&quot;margin-top: 0px; margin-bottom: 0px; padding: 0px; border: none; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; overflow: auto; line-height: 22.4px; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;info&amp;quot;&lt;/span&gt;: [{&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;url&amp;quot;&lt;/span&gt;: &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;http://xxx&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;}]&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;那么系统必须提供这种映射的绑定策略：&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure class=&quot;highlight haskell&quot; style=&quot;margin: 0px; padding: 15px 20px; border-style: solid; border-color: rgb(221, 221, 221); border-width: 1px 0px; overflow: auto; color: rgb(77, 77, 76); line-height: 22.4px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; white-space: normal; background: rgb(255, 255, 255);&quot;&gt;&lt;table width=&quot;NaN&quot;&gt;&lt;tbody style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;&lt;tr style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot; class=&quot;firstRow&quot;&gt;&lt;td class=&quot;gutter&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td class=&quot;code&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;pre style=&quot;margin-top: 0px; margin-bottom: 0px; padding: 0px; border: none; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; overflow: auto; line-height: 22.4px; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&lt;span class=&quot;title&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(142, 144, 140);&quot;&gt;info&lt;/span&gt;/name -&amp;gt; &lt;span class=&quot;typedef&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;&lt;span class=&quot;keyword&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(137, 89, 168);&quot;&gt;data&lt;/span&gt;/item_name&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&lt;span class=&quot;title&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(142, 144, 140);&quot;&gt;info&lt;/span&gt;/url -&amp;gt; &lt;span class=&quot;typedef&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;&lt;span class=&quot;keyword&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(137, 89, 168);&quot;&gt;data&lt;/span&gt;/item_url&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;绑定之后，数据既可以同步输出，也可以异步输出，这些都是平台提供的能力。这个方案基本上解决了后端系统/接口变化的问题，并且减少了前后端之间的沟通成本。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;不过这里需要注意的是，虽然页面上的接口都通过平台统一梳理了一次，这也意味着，页面所有的请求会先流经平台，然后分发到各个后端，平台的抗压能力要求很高。&lt;/p&gt;&lt;h4 id=&quot;2-_PHP__u5230_Node__u7684_u53D8_u8FC1&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.2em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#2-_PHP__u5230_Node__u7684_u53D8_u8FC1&quot; class=&quot;headerlink&quot; title=&quot;2. PHP 到 Node 的变迁&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 21.6000003814697px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;2. PHP 到 Node 的变迁&lt;/h4&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;淘宝首页日均请求的这个量级，不可能是十几二十台台服务器抗得住的，支撑它必须有一个服务集群。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww4.sinaimg.cn/large/6c0378f8gw1f4g6rdqpd0j212o0s076f.jpg&quot; alt=&quot;集群&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;每一个 CDN 节点上都具备 PHP 渲染的能力，当页面发布时，我们把该页面所有的模块和数据同步到全部 CDN 节点上，基本模式大概就是如此了。看起来还挺不错，但是经过一段时间的运维，很多安全、性能问题都慢慢浮现出来了：&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;em style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;性能问题。&lt;/em&gt;&amp;nbsp;每个 PHP 页面包含多个子模块，而子模块也有可能引用了其他的子模块，PHP 的&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;include&lt;/code&gt;&amp;nbsp;操作是存在消耗的，每一次引用都是一次磁盘 IO，一个渲染节点上跑了成千上万个类似淘宝首页的 PHP 页面，并发一高其效率可想而知。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;em style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;推送机制问题。&lt;/em&gt;&amp;nbsp;文件同步（图中的&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;sync&lt;/code&gt;&amp;nbsp;动作）是一种比较恶心的机制，首先，时间上没法控制，一个文件同步到所有的节点，快则几秒钟，慢的话耗时会超过一两分钟；并且同步过程还有可能失败，健康检测的成本也是相当高的。发布比较紧凑时，需要同步的文件也很多，很容易造成队列堆积，加剧同步差的体验。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;em style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;实时性强需求问题。&lt;/em&gt;&amp;nbsp;文件在推送之前，还可能经过一些前置系统，发布链路越长，线上生效时间越慢，慢的时候大约五分钟才生效，这样的延时对于实时性要求很高（如秒杀）的需求来说是完全不能接受的。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;当然，还有很多其他问题，如运维成本增高、安全风险增高、PHP 资深人才储备不足等等。所以 PHP 渲染容器的命运，就是，被干掉。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww4.sinaimg.cn/large/6c0378f8gw1f4g7eogvy9j21840tatb1.jpg&quot; alt=&quot;回源&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;上图改变了下玩法，服务集群为 Cache CDN，它只有静态文件处理能力，没有 PHP/Node 的渲染能力，所以处理效率高，性能也好，抗压能力相当强，并且扛不住的时候还可以花钱买服务，拓展 Cache 集群。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;用户访问时，Nginx 转到 Cache CDN，如果命中缓存则直接返回，没有命中便回源到源站服务器。源站服务器是具备模块渲染能力的 Node 服务，它可以做很多事情：&lt;/p&gt;&lt;ul style=&quot;list-style-type: square;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;控制 Cache 响应头，通过&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;max-age&lt;/code&gt;&amp;nbsp;和&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;s-maxage&lt;/code&gt;&amp;nbsp;控制页面在客户端的缓存时间以及在 Cache 上的缓存时间，这个缓存时间可以根据需求随时做调整，比如大促的时候调长一些&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;控制内外网环境，和 AB 测试状态&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;融合前端相关的工具链，比如检测、压缩、过滤等等&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;它的优势有很多，这里不一一列举了。这个模式中还添加了一层容灾，源站服务器每隔一段时间将数据推送到于 Cache 同机房的备份服务器，一点源站挂了，还能够自动容灾到备份数据上。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;模式的变化不仅在运维上有了突破，CDN 被攻击时的安全风险也低了很多，同时也省却了 sync 所需的各种检测机制，每年节约成本也是百万以上，优势还是相当明显。&lt;/p&gt;&lt;h4 id=&quot;3-_Node_uFF0C_u4E0D_u4E00_u6837_u7684_u6A21_u5F0F&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.2em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#3-_Node_uFF0C_u4E0D_u4E00_u6837_u7684_u6A21_u5F0F&quot; class=&quot;headerlink&quot; title=&quot;3. Node，不一样的模式&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 21.6000003814697px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;3. Node，不一样的模式&lt;/h4&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;上面 PHP 模块中，我们只说了 HTML 和数据部分，用心的读者应该已经发现，CSS 和 JS 这些静态资源都没提到，那页面是如何渲染的呢？&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;旧版 PHP 页面中，我们是直接引入了一个 CSS 和一个 JS，淘宝这边采用的是 git 版本迭代发布，这些静态资源都是直接放在一个 git 仓库中。也就是这样：&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure class=&quot;highlight php&quot; style=&quot;margin: 0px; padding: 15px 20px; border-style: solid; border-color: rgb(221, 221, 221); border-width: 1px 0px; overflow: auto; color: rgb(77, 77, 76); line-height: 22.4px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; white-space: normal; background: rgb(255, 255, 255);&quot;&gt;&lt;table width=&quot;NaN&quot;&gt;&lt;tbody style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;&lt;tr style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot; class=&quot;firstRow&quot;&gt;&lt;td class=&quot;gutter&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td class=&quot;code&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;pre style=&quot;margin-top: 0px; margin-bottom: 0px; padding: 0px; border: none; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; overflow: auto; line-height: 22.4px; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&amp;lt;link rel=&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; href=&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;//cdn/@VERSION@/index.css&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&amp;lt;script src=&lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;quot;//cdn/@VERSION@/index.js&amp;quot;&lt;/span&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= loadModule(Mod1ID) &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= loadModule(Mod2ID) &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= loadModule(Mod3ID, &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;#39;lazyload&amp;#39;&lt;/span&gt;) &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= loadModule(Mod4ID, &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;#39;lazyload&amp;#39;&lt;/span&gt;) &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;&amp;lt;?&lt;/span&gt;= loadModule(Mod5ID, &lt;span class=&quot;string&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(113, 140, 0);&quot;&gt;&amp;#39;lazyload&amp;#39;&lt;/span&gt;) &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;每次发布完 git 文件，再修改 PHP 的版本号，然后发布 PHP 代码。当然，也做了相关的优化，比如发布 git 时自动更新版本号等。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;而新版搭建平台的页面渲染模式与 PHP 的模式不太一样。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/6c0378f8gw1f4g8566uz3j21kw0yt79h.jpg&quot; alt=&quot;Node渲染模型&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;一个模块的 CSS/JS 和模板放在一起，CSS/JS 与页面其他模块的静态资源是相互独立的，目的就是希望单个模块也能够完整的跑起来，更加利于模块的复用。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;而模块的挖坑，也从模板中独立了出来，采用 JSON Schema 的形式定义数据格式，&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;figure class=&quot;highlight axapta&quot; style=&quot;margin: 0px; padding: 15px 20px; border-style: solid; border-color: rgb(221, 221, 221); border-width: 1px 0px; overflow: auto; color: rgb(77, 77, 76); line-height: 22.4px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; white-space: normal; background: rgb(255, 255, 255);&quot;&gt;&lt;table width=&quot;NaN&quot;&gt;&lt;tbody style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;&lt;tr style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot; class=&quot;firstRow&quot;&gt;&lt;td class=&quot;gutter&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td class=&quot;code&quot; style=&quot;margin: 0px; padding: 0px; border: none; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: middle;&quot;&gt;&lt;pre style=&quot;margin-top: 0px; margin-bottom: 0px; padding: 0px; border: none; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; overflow: auto; line-height: 22.4px; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;.&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;├── &lt;span class=&quot;keyword&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(137, 89, 168);&quot;&gt;index&lt;/span&gt;.css &amp;nbsp; &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;# 模块样式&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;├── &lt;span class=&quot;keyword&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(137, 89, 168);&quot;&gt;index&lt;/span&gt;.js &amp;nbsp; &amp;nbsp; &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;# 模块渲染脚本&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;├── schema.json &amp;nbsp;&lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;# schema 配置&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; height: 22.4px;&quot;&gt;└── &lt;span class=&quot;keyword&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(137, 89, 168);&quot;&gt;index&lt;/span&gt;.xtpl &amp;nbsp; &lt;span class=&quot;preprocessor&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(245, 135, 31);&quot;&gt;# 模块的模板&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;搭建平台通过这个 JSON Schema 解析成&amp;nbsp;&lt;a href=&quot;http://ww4.sinaimg.cn/large/6c0378f8gw1f4g54zdicej20do09cdfy.jpg&quot; target=&quot;_blank&quot; rel=&quot;external&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;图一&lt;/a&gt;&amp;nbsp;的坑位。那么一个模块的渲染就变成了&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;index.xtpl&lt;/code&gt;&amp;nbsp;和挖坑数据之间的拼装了。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;模块之间相互独立隔离，所以会存在一定程度的冗余，不过模块解偶带来的收益要比这点冗余要多得多。事实上，我们是通过一个仓库去管理单个模块的。页面的渲染就比较简单了，源站 Node 容器会将所有的&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;index.xtpl&lt;/code&gt;&amp;nbsp;合并成一个&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;page.xtpl&lt;/code&gt;，为减少页面请求，css 和 js 也会 combo 成一个文件，如上图所示的&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;http://cdn/??mod1.css,mod2.css,mod3.css&lt;/code&gt;。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;任何模块的更新，页面都会有感知，下次进入系统时，就会提示是否需要升级模块和页面。&lt;/p&gt;&lt;h3 id=&quot;u4E09_u3001_u6DD8_u5B9D_u9996_u9875_u7684_u6027_u80FD_u4F18_u5316&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.3em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#u4E09_u3001_u6DD8_u5B9D_u9996_u9875_u7684_u6027_u80FD_u4F18_u5316&quot; class=&quot;headerlink&quot; title=&quot;三、淘宝首页的性能优化&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 23.3999996185303px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;三、淘宝首页的性能优化&lt;/h3&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;首页模块众多，如果一口气吐出来，DOM 数量必然超过 4k 个，其结果就是首屏时间极长。按照 TMS 的开发规范，每个 TMS 模块都包含一个&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;index.js&lt;/code&gt;&amp;nbsp;和&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;index.css&lt;/code&gt;，最后展示出来两个 combo 的 js 和 css。首页加载的时候也不会一口气执行所有&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;index.js&lt;/code&gt;，否则刚开始页面阻塞会十分严重。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;strong style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;页面的渲染逻辑&lt;/strong&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww2.sinaimg.cn/large/6c0378f8gw1f4gse45ss8j20fn0jr0v3.jpg&quot; alt=&quot;页面的渲染逻辑&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;首页框架的加载逻辑，大致上图所示：&lt;/p&gt;&lt;ul style=&quot;list-style-type: square;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;遍历所有 TMS 模块（包含一个&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;J_Module&lt;/code&gt;&amp;nbsp;的钩子）&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;部分 TMS 模块无 JS 内容，但是加载了一个&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;index.js&lt;/code&gt;，为模块添加&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;tb-pass&lt;/code&gt;&amp;nbsp;的 class，用于跳过该模块 JS 的执行&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;将页面分为两块，首屏为一块，非首屏整体为第二块，先将首屏模块加入到懒加载监控&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;待首屏模块加载完成，或者用户处理了页面交互时（滚动、鼠标移动等），将非首屏模块加入到懒加载监控&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;处理一些特殊模块，它们会在进入视窗之前几百像素就开始加载&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;监控滚动，按照以上逻辑，渲染模块&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;部分模块即便是被执行了，也不一定渲染出来，因为它的优先级不高，在模块内部加了事件监听，比如等到&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;mouseover/onload&lt;/code&gt;&amp;nbsp;事件触发的时候再渲染这些内容。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;之前写过性能优化相关的文章，复制就没必要了，直接贴地址：&lt;/p&gt;&lt;ul style=&quot;list-style-type: square;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/04/05/optimize-in-tbhome/&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none; word-break: break-all;&quot;&gt;《淘宝首页性能优化实践》&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;代码的性能优化是一个精细活，如果你要在一个庞大的未经优化的页面上做性能优化，可能会面临一次重构代码。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;上面的文章提到的是页面内部的细节优化，但是在开发流程中做的规范化、标准化，以及线上访问通路中的各个环节优化还没有提及。&lt;/p&gt;&lt;h3 id=&quot;u56DB_u3001_u6DD8_u5B9D_u9996_u9875_u7684_u7A33_u5B9A_u6027_u4FDD_u969C&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.3em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#u56DB_u3001_u6DD8_u5B9D_u9996_u9875_u7684_u7A33_u5B9A_u6027_u4FDD_u969C&quot; class=&quot;headerlink&quot; title=&quot;四、淘宝首页的稳定性保障&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 23.3999996185303px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;四、淘宝首页的稳定性保障&lt;/h3&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;在大流量下，任何小问题都会被放大成大问题，所以开发环节遇到的任何偶发性问题都需要引起重视。不过很多偶发性问题在我们的测试环境中是找不到的，比如与地域相关的问题（如上海的某个 CDN 节点挂了），用户属性问题（如 nickname 最后一个为字母 s 的用户页面天窗），浏览器插件问题，运营商广告注入问题等等。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;难以在上线之前把所有问题考虑周全，但是有两点是必须做好的：&lt;strong style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-style: inherit; font-family: inherit; vertical-align: baseline;&quot;&gt;兜底容灾 + 监控预警。&lt;/strong&gt;&lt;/p&gt;&lt;h4 id=&quot;1-__u515C_u5E95_u5BB9_u707E_u673A_u5236&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.2em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#1-__u515C_u5E95_u5BB9_u707E_u673A_u5236&quot; class=&quot;headerlink&quot; title=&quot;1. 兜底容灾机制&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 21.6000003814697px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;1. 兜底容灾机制&lt;/h4&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;兜底容灾有两个层面的考虑：&lt;/p&gt;&lt;ul style=&quot;list-style-type: square;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;异步接口请求错误，包括接口数据格式错误，接口请求超时等&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;同步渲染，源站页面渲染出错&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;异步接口请求，主要涉及到的是后台系统，对接系统较多，各个系统的稳定性和抗压能力各不相同，这方面的保障有多种方案，下面是最常见的：&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww4.sinaimg.cn/large/6c0378f8gw1f4go51ui9zj20kh0h7n0b.jpg&quot; alt=&quot;请求缓存&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;每次数据请求都缓存到本地，并且为每个接口都提供一个硬兜底。还有一种方案是「重试」，请求一次不成功那就请求第二次。这方面的讨论具体可以看看之前写的这篇文章：&lt;a href=&quot;http://taobaofed.org/blog/2015/10/28/disaster-recovery-at-taobao-home-page/&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;《淘宝首页兜底容灾方案》&lt;/a&gt;。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;对于同步渲染，它只需要页面模板和同步数据，两者中任一种存在错误，源站都会报错，此时回源返回的内容就是一个 error 页面，状态码为&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;5xx&lt;/code&gt;。这个错误不一定是开发者造成的，有可能是系统链路出现同步异常或者断路问题。针对这种问题，我给淘宝首页做了一个镜像页：&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/6c0378f8gw1f4gonwmraoj21ce0rq0vr.jpg&quot; alt=&quot;镜像&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;一旦源站任何异常，Nginx 都会转到与 Cache CDN 同机房的首页镜像上去，这个镜像内容就是淘宝首页的 HTML 备份源码。&lt;/p&gt;&lt;h4 id=&quot;2-__u76D1_u63A7_u9884_u8B66_u673A_u5236&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.2em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#2-__u76D1_u63A7_u9884_u8B66_u673A_u5236&quot; class=&quot;headerlink&quot; title=&quot;2. 监控预警机制&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 21.6000003814697px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;2. 监控预警机制&lt;/h4&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;监控也有两个层面：&lt;/p&gt;&lt;ul style=&quot;list-style-type: square;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;模块级别的监控，接口请求布点、模块天窗检测等&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;页面的监控，在页面上添加特殊标记，定时回归所有 CDN 节点，查看特殊标记是否存在&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;模块层面的监控，内容还是相当多的，监控的点越多越详细，到最后定位问题的效率就会越高，比如在一个稍微复杂的模块上，我会埋下这些监控：&lt;/p&gt;&lt;ul style=&quot;list-style-type: square;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;接口请求格式错误、请求失败、请求超时，至少三个埋点&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;硬兜底数据请求失败埋点&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;模块 5s 内没有渲染完成统计埋点&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;模块内链接和图片黑白名单匹配埋点&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/6c0378f8gw1f4gtw0jjxxj20w50akace.jpg&quot; alt=&quot;监控&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;其中部分监控还会自动处理明确的错误，比如 https 页面下出现了 http 的图片，会立即自动处理掉这些问题。&lt;/p&gt;&lt;h4 id=&quot;3-__u4E0A_u7EBF_u524D_u7684_u81EA_u52A8_u5316_u68C0_u6D4B&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.2em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#3-__u4E0A_u7EBF_u524D_u7684_u81EA_u52A8_u5316_u68C0_u6D4B&quot; class=&quot;headerlink&quot; title=&quot;3. 上线前的自动化检测&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 21.6000003814697px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;3. 上线前的自动化检测&lt;/h4&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;这属于淘宝整个工程化环境的一部分，前端自动化测试。一般会在上线之前处理这些问题：&lt;/p&gt;&lt;ul style=&quot;list-style-type: square;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;检测 HTML 是否符合规范&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;检测 https 升级情况&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;检测链接合法性&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;检测静态资源合法性&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;检测 JavaScript 报错&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;检测页面加载时是否有弹出框&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;检测页面是否调用&amp;nbsp;&lt;code style=&quot;margin: 0px; padding: 0px 0.3em; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: &amp;#39;Source Code Pro&amp;#39;, Consolas, Monaco, Menlo, Consolas, monospace; font-size: 14px; vertical-align: baseline; text-shadow: rgb(255, 255, 255) 0px 1px; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;&quot;&gt;console.*&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;页面 JS 内存记录&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;当然，也可以自己添加测试用例，比如检测接口数据格式、模块天窗问题等。自动化检测也可以设定定时回归，还是比较有保障的。&lt;/p&gt;&lt;h3 id=&quot;u4E94_u3001_u6DD8_u5B9D_u9996_u9875_u7684_u654F_u6377_u63AA_u65BD&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.3em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#u4E94_u3001_u6DD8_u5B9D_u9996_u9875_u7684_u654F_u6377_u63AA_u65BD&quot; class=&quot;headerlink&quot; title=&quot;五、淘宝首页的敏捷措施&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 23.3999996185303px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;五、淘宝首页的敏捷措施&lt;/h3&gt;&lt;h4 id=&quot;1-__u5065_u5EB7_u68C0_u67E5&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.2em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#1-__u5065_u5EB7_u68C0_u67E5&quot; class=&quot;headerlink&quot; title=&quot;1. 健康检查&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 21.6000003814697px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;1. 健康检查&lt;/h4&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;页面模块众多，为了能够追踪页面上每一个小点的变化，我在请求、渲染的每一个环节都做了详细的统计，如下图所示：&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww3.sinaimg.cn/large/6c0378f8gw1f4gt6p2lsfj20la0gmjwg.jpg&quot; alt=&quot;Console&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;一旦接口请求失败，或者接口走了容灾逻辑，或者模块渲染超过 5s，控制台都会有黄色警报，当然此时，也已经向服务器发送了警报统计。&lt;/p&gt;&lt;h4 id=&quot;2-__u63A5_u53E3_Hub&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.2em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#2-__u63A5_u53E3_Hub&quot; class=&quot;headerlink&quot; title=&quot;2. 接口 Hub&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 21.6000003814697px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;2. 接口 Hub&lt;/h4&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;接口 Hub 是对数据请求的管理工具，如下图所示：&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;img src=&quot;http://ww1.sinaimg.cn/large/6c0378f8gw1f4gt7e0p74j20j70cvtbv.jpg&quot; alt=&quot;HubCache&quot; style=&quot;margin: auto; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline; max-width: 100%; height: auto; display: block;&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;页面很多模块的渲染都需要一个以上的数据源，一旦运营反馈页面渲染数据异常，可以直接通过 Hub 找到数据，加速 Bug 定位效率。同时 Hub 也可以用来切换环境，将一个接口的请求切换到日常或者预发环境的接口之中，它是调试的利器。&lt;/p&gt;&lt;h4 id=&quot;3-__u5FEB_u6377_u901A_u9053&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.2em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#3-__u5FEB_u6377_u901A_u9053&quot; class=&quot;headerlink&quot; title=&quot;3. 快捷通道&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 21.6000003814697px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;3. 快捷通道&lt;/h4&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;我在页面脚本执行前后都放了一个快捷操作通道，一旦遇到紧急线上问题，比如样式错乱溢出、接口报错导致天窗等，可以通过快捷通道直接修改页面的 CSS 和 JS，两分钟内上线。&lt;/p&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;不过这类通道只适合紧急问题的修复，毕竟随意插入 JS 代码是存在很大风险的。&lt;/p&gt;&lt;h3 id=&quot;u516D_u3001_u5C0F_u7ED3&quot; style=&quot;margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 1.3em; vertical-align: baseline; line-height: 1.3em; color: rgb(85, 85, 85); white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;&lt;a href=&quot;http://taobaofed.org/blog/2016/06/02/thing-about-taobao-homepage/#u516D_u3001_u5C0F_u7ED3&quot; class=&quot;headerlink&quot; title=&quot;六、小结&quot; style=&quot;margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; font-size: 23.3999996185303px; vertical-align: baseline; color: rgb(98, 187, 195); text-decoration: none;&quot;&gt;&lt;/a&gt;六、小结&lt;/h3&gt;&lt;p style=&quot;margin-top: 1.6em; margin-bottom: 1.6em; padding: 0px; border: 0px; outline: 0px; font-family: &amp;#39;lucida grande&amp;#39;, &amp;#39;lucida sans unicode&amp;#39;, lucida, &amp;#39;Helvetica Neue&amp;#39;, helvetica, &amp;#39;Hiragino Sans GB&amp;#39;, &amp;#39;Microsoft YaHei&amp;#39;, &amp;#39;WenQuanYi Micro Hei&amp;#39;, sans-serif; font-size: 18px; vertical-align: baseline; color: rgb(85, 85, 85); line-height: 28.7999992370605px; white-space: normal; background-color: rgb(255, 255, 255);&quot;&gt;写的好像有点虎头蛇尾（码字和画图都太累），还有很多方面没有延伸拓展开。希望以上可以让你对淘宝首页有一个基本的认识。&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;', 10, 10, 1465155692, 1465158309);
INSERT INTO `cjt_article` (`id`, `title`, `author`, `coverpic`, `abstract`, `content`, `readnum`, `sortid`, `time`, `lastmodifytime`) VALUES
(196, '测试15', '', 'default.jpg', '测试摘要15', '&lt;p&gt;测试内容15&lt;/p&gt;', 1, 1, 1465158332, 1465158332);

-- --------------------------------------------------------

--
-- 表的结构 `cjt_articletag`
--

CREATE TABLE IF NOT EXISTS `cjt_articletag` (
  `articleid` int(5) DEFAULT NULL COMMENT '文章id',
  `tagid` int(5) DEFAULT NULL COMMENT '文章标签id'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `cjt_articletag`
--

INSERT INTO `cjt_articletag` (`articleid`, `tagid`) VALUES
(182, 1),
(182, 2),
(182, 3),
(183, 1),
(183, 2),
(183, 10),
(184, 3),
(184, 8),
(185, 8),
(185, 10),
(185, 11),
(186, 2),
(186, 3),
(186, 8),
(187, 2),
(187, 8),
(187, 10),
(188, 2),
(188, 8),
(188, 11),
(189, 1),
(189, 2),
(189, 3),
(189, 10),
(190, 1),
(190, 2),
(190, 3),
(190, 8),
(190, 10),
(190, 11),
(191, 1),
(191, 2),
(191, 3),
(191, 8),
(191, 10),
(191, 11),
(192, 1),
(192, 2),
(192, 3),
(192, 8),
(193, 1),
(193, 2),
(193, 8),
(193, 11),
(194, 1),
(194, 2),
(194, 8);

-- --------------------------------------------------------

--
-- 表的结构 `cjt_comment`
--

CREATE TABLE IF NOT EXISTS `cjt_comment` (
  `commentid` int(5) unsigned NOT NULL AUTO_INCREMENT COMMENT '评论id',
  `commentcontent` text NOT NULL COMMENT '评论内容',
  `commentauthor` varchar(50) NOT NULL COMMENT '评论者',
  `personsite` varchar(50) DEFAULT NULL COMMENT '评论者个人站点',
  `commenttime` int(50) NOT NULL COMMENT '评论时间',
  `articleid` int(5) DEFAULT NULL COMMENT '评论所在文章id',
  `status` tinyint(5) DEFAULT '0' COMMENT '留言审核状态，0表示待审核，1表示审核通过',
  PRIMARY KEY (`commentid`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=90 ;

--
-- 转存表中的数据 `cjt_comment`
--

INSERT INTO `cjt_comment` (`commentid`, `commentcontent`, `commentauthor`, `personsite`, `commenttime`, `articleid`, `status`) VALUES
(89, '测试留言1', '测试留言人1', 'http://测试留言人站点1', 1465156373, 195, 1);

-- --------------------------------------------------------

--
-- 表的结构 `cjt_sort`
--

CREATE TABLE IF NOT EXISTS `cjt_sort` (
  `sortid` int(5) unsigned NOT NULL AUTO_INCREMENT COMMENT '分类id',
  `sortname` varchar(40) DEFAULT NULL COMMENT '分类名称',
  PRIMARY KEY (`sortid`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=27 ;

--
-- 转存表中的数据 `cjt_sort`
--

INSERT INTO `cjt_sort` (`sortid`, `sortname`) VALUES
(1, '前端'),
(10, 'PHP'),
(11, 'SASS'),
(12, 'Github'),
(14, '生活'),
(25, 'Nodejs'),
(26, 'ThinkPHP');

-- --------------------------------------------------------

--
-- 表的结构 `cjt_tag`
--

CREATE TABLE IF NOT EXISTS `cjt_tag` (
  `tagid` int(5) unsigned NOT NULL AUTO_INCREMENT,
  `tagname` varchar(40) NOT NULL COMMENT '文章标签名称',
  PRIMARY KEY (`tagid`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=12 ;

--
-- 转存表中的数据 `cjt_tag`
--

INSERT INTO `cjt_tag` (`tagid`, `tagname`) VALUES
(1, 'jQuery'),
(2, 'Bootstrap'),
(3, 'JavaScript'),
(8, 'PHP'),
(10, 'nodejs'),
(11, 'reactjs');

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
